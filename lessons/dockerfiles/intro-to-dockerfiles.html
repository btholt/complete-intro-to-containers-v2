<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>Intro to Dockerfiles – Complete Intro to Containers</title><meta name="description" content="Learn how to build Docker containers with a Dockerfile, the key instructions involved, and the concept of disposable containers. Discover the power of creating container images incrementally by leveraging existing images in the Docker ecosystem."/><meta name="keywords" content="Docker containers,Dockerfile,building containers,disposable containers,docker run command,container versioning"/><meta name="og:description" content="Learn how to build Docker containers with a Dockerfile, the key instructions involved, and the concept of disposable containers. Discover the power of creating container images incrementally by leveraging existing images in the Docker ecosystem."/><meta name="og:title" content="Intro to Dockerfiles – Complete Intro to Containers"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="14"/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/css/cfac17cb37b27821.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/cfac17cb37b27821.css" crossorigin="" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-4e7214a60fad8e88.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-5429a50ba5373c56.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-d2ba44903cd47711.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-564cf6bb10408614.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-ba225542c35827e2.js" defer="" crossorigin=""></script><script src="/_next/static/nARcRKX1ZlcrYUdSUSS9z/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/nARcRKX1ZlcrYUdSUSS9z/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to Containers</a></h1><div class="navbar-info"><a href="https://holt.fyi/containers" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>So far we&#39;ve been focusing a lot on running containers and haven&#39;t much dug into building them. This is on purpose because most of benefit of containers for developers comes from the running of containers. If you learn one thing, it should be how to run them. In fact I&#39;ll event venture to say that <em>most</em> developers really only ever need to know how to run them. But you, you&#39;re going to learn how to write them. It&#39;s an extra superpower.</p>
<p>That said, let&#39;s learn to build our own containers. We&#39;ll again be using Docker for this though there are other ways to do this. Docker has a special file called a <code>Dockerfile</code> which allows you to outline how a container will be built. Each line in a Docker file is a new a directive of how to change your Docker container.</p>
<p>A <em>big key</em> with Docker container is that they&#39;re supposed to be disposable. You should be able to create them and throw them away as many times as necessary. In other words: adopt a mindset of making everything short-lived. There are other, better tools for long-running, custom containers.</p>
<p>The (imperfect) analogy that people use sometimes is your containers should be &quot;<a href="http://cloudscaling.com/blog/cloud-computing/the-history-of-pets-vs-cattle/">cattle, not pets</a>&quot;. You design containers so you can easily create and destroy them as much as necessary. The analogy here is that you name your pets and take special care of them whereas you have a thousand cattle and can&#39;t name or take special care of them, just the herd.</p>
<p>Let&#39;s make the most basic Dockerfile ever. Let&#39;s make a new folder, maybe on your desktop. Put a file in there called <code>Dockerfile</code> (no extension.) In your file, put this.</p>
<h2>The most basic Dockerfile-based Container</h2>
<pre><code class="hljs language-dockerfile"><span class="hljs-keyword">FROM</span> node:<span class="hljs-number">20</span>

<span class="hljs-keyword">CMD</span><span class="language-bash"> [<span class="hljs-string">&quot;node&quot;</span>, <span class="hljs-string">&quot;-e&quot;</span>, <span class="hljs-string">&quot;console.log(\&quot;hi lol\&quot;)&quot;</span>]</span>
</code></pre><p><a href="https://github.com/btholt/project-files-for-complete-intro-to-containers-v2/blob/main/intro-to-dockerfiles/Dockerfile">⛓️ Link to the Dockerfile</a></p>
<p>The first thing on each line (<code>FROM</code> and <code>CMD</code> in this case) are called <em>instructions</em>. They don&#39;t technically have to be all caps but it&#39;s convention to do so so that the file is easier to read. Each one of these instruction incrementally changes the container from the state it was in previously, adding what we call a <em>layer</em>.</p>
<p>Let&#39;s go ahead and build our container. Run (from inside of the directory of where your Dockerfile is)</p>
<pre><code class="hljs language-bash">docker build .
</code></pre><p>You should see it out put a bunch of stuff and it&#39;ll leave you with the hash of an image. After each instruction, you&#39;ll see a hash similar to the ones we&#39;ve been using for the IDs for the containers. You know why that is? It&#39;s because each one of those layers is in-and-of themselves a valid container image! This ends up being important later and we&#39;ll discuss it in a bit.</p>
<p>Our container has two instructions in its Dockerfile, but actually it has many, many more. How? The first instruction, <code>FROM node:20</code> actually means <em>start</em> with the <code>node</code> container. That container itself <a href="https://github.com/nodejs/docker-node/blob/master/Dockerfile-debian.template">comes from another Dockerfile</a> which build its own container, which itself <a href="https://github.com/docker-library/buildpack-deps">comes from another Dockerfile</a>, which comes ultimately from the <a href="https://hub.docker.com/_/debian/">Debian</a> image.</p>
<p>This is something very powerful about Docker: you can use images to build other images and build on the work of others. Instead of having to worry about how to install Debian and all the necessary items to build Node.js from its source, we can just start with a well-put-together image from the community.</p>
<p>Okay, so we start with <code>node:20</code> and then we add the <code>CMD</code> instruction. There will only ever be one of these in effect in a Dockerfile. If you have multiple it&#39;ll just take the last one. This is what you want Docker to do when someone runs the container. In our case, we&#39;re running <code>node -e &quot;console.log(&#39;hi lol&#39;)&quot;</code> from within the container. <code>node -e</code>, if you don&#39;t know, will run whatever is inside of the quotes with Node.js. In this case, we&#39;re logging out <code>hi lol</code> to the console.</p>
<p>You <em>can</em> put <code>CMD node -e &quot;console.log(&#39;hi lol&#39;)&quot;</code> as that last line and it&#39;ll work but it&#39;s not the preferred way of doing it. This won&#39;t actually go through bash which itself is simpler and usually safer. I do it this way because the docs strongly encourage you to do it this way.</p>
<p>So, in essence, our containers nabs a <code>node:20</code> container and then when we have it execute a <code>node</code> command when you run it. Let&#39;s try it. Grab the hash from your build and run</p>
<pre><code class="hljs language-bash">docker run &lt;ID&gt;
</code></pre><p>It&#39;s a little inconvenient to always have to refer to it by ID, it&#39;d be easier if it had a name. So let&#39;s do that! Try</p>
<pre><code class="hljs language-bash">docker build . --tag my-node-app <span class="hljs-comment">## or -t instead of --tag</span>
docker run my-node-app
</code></pre><p>Much easier to remember the name rather than a hash. If you want to version it yourself, you can totally do this:</p>
<pre><code class="hljs language-bash">docker build -t my-node-app:1 .
docker run my-node-app:1
</code></pre><p>Now change your <code>Dockerfile</code> so that it logs out <code>wat</code> instead of <code>hi lol</code>. After you do that.</p>
<pre><code class="hljs language-bash">docker build -t my-node-app:2 .
docker run my-node-app:2
docker run my-node-app:1
</code></pre><p>You can version your containers and hold on to older ones, just in case!</p>
</div><div class="lesson-links"><a href="/lessons/docker/docker-cli" class="prev">← Previous</a><a href="/lessons/dockerfiles/build-a-nodejs-app" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="32" viewBox="0 0 40 32"><defs><clipPath id="clip-twitter-social"><rect width="40" height="32"></rect></clipPath></defs><g id="twitter-social" clip-path="url(#clip-twitter-social)"><g id="Group_269" data-name="Group 269" transform="translate(-230.23 -1140.849)"><path id="Path_419" data-name="Path 419" d="M266.12,1148.861v1.035a23.092,23.092,0,0,1-1.507,8.1,24.08,24.08,0,0,1-4.475,7.381,22.175,22.175,0,0,1-7.306,5.4,24.129,24.129,0,0,1-10,2.07,23.7,23.7,0,0,1-6.667-.945,22.83,22.83,0,0,1-5.936-2.655q.959.091,1.963.09a16.518,16.518,0,0,0,5.434-.9,17.111,17.111,0,0,0,4.749-2.52,8.275,8.275,0,0,1-4.749-1.643,7.8,7.8,0,0,1-2.877-3.983,8.268,8.268,0,0,0,1.507.135,8.58,8.58,0,0,0,2.146-.27,8.16,8.16,0,0,1-5.685-4.344,8.326,8.326,0,0,1-.89-3.578v-.135a7.775,7.775,0,0,0,3.744,1.035,8.183,8.183,0,0,1-2.671-2.9,7.817,7.817,0,0,1-.982-3.848,7.948,7.948,0,0,1,1.1-4.05,23.53,23.53,0,0,0,16.895,8.46,9.221,9.221,0,0,1-.183-1.845,7.787,7.787,0,0,1,1.1-4.05,8.216,8.216,0,0,1,2.991-2.948,7.991,7.991,0,0,1,4.087-1.1,8.184,8.184,0,0,1,5.982,2.566,16.087,16.087,0,0,0,5.205-1.98,7.784,7.784,0,0,1-1.393,2.588,8.4,8.4,0,0,1-2.215,1.913,16.856,16.856,0,0,0,4.749-1.305A17.032,17.032,0,0,1,266.12,1148.861Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"post":{"attributes":{"description":"Learn how to build Docker containers with a Dockerfile, the key instructions involved, and the concept of disposable containers. Discover the power of creating container images incrementally by leveraging existing images in the Docker ecosystem.","keywords":["Docker containers","Dockerfile","building containers","disposable containers","docker run command","container versioning"]},"html":"\u003cp\u003eSo far we\u0026#39;ve been focusing a lot on running containers and haven\u0026#39;t much dug into building them. This is on purpose because most of benefit of containers for developers comes from the running of containers. If you learn one thing, it should be how to run them. In fact I\u0026#39;ll event venture to say that \u003cem\u003emost\u003c/em\u003e developers really only ever need to know how to run them. But you, you\u0026#39;re going to learn how to write them. It\u0026#39;s an extra superpower.\u003c/p\u003e\n\u003cp\u003eThat said, let\u0026#39;s learn to build our own containers. We\u0026#39;ll again be using Docker for this though there are other ways to do this. Docker has a special file called a \u003ccode\u003eDockerfile\u003c/code\u003e which allows you to outline how a container will be built. Each line in a Docker file is a new a directive of how to change your Docker container.\u003c/p\u003e\n\u003cp\u003eA \u003cem\u003ebig key\u003c/em\u003e with Docker container is that they\u0026#39;re supposed to be disposable. You should be able to create them and throw them away as many times as necessary. In other words: adopt a mindset of making everything short-lived. There are other, better tools for long-running, custom containers.\u003c/p\u003e\n\u003cp\u003eThe (imperfect) analogy that people use sometimes is your containers should be \u0026quot;\u003ca href=\"http://cloudscaling.com/blog/cloud-computing/the-history-of-pets-vs-cattle/\"\u003ecattle, not pets\u003c/a\u003e\u0026quot;. You design containers so you can easily create and destroy them as much as necessary. The analogy here is that you name your pets and take special care of them whereas you have a thousand cattle and can\u0026#39;t name or take special care of them, just the herd.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s make the most basic Dockerfile ever. Let\u0026#39;s make a new folder, maybe on your desktop. Put a file in there called \u003ccode\u003eDockerfile\u003c/code\u003e (no extension.) In your file, put this.\u003c/p\u003e\n\u003ch2\u003eThe most basic Dockerfile-based Container\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-dockerfile\"\u003e\u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e node:\u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003eCMD\u003c/span\u003e\u003cspan class=\"language-bash\"\u003e [\u003cspan class=\"hljs-string\"\u003e\u0026quot;node\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;-e\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026quot;console.log(\\\u0026quot;hi lol\\\u0026quot;)\u0026quot;\u003c/span\u003e]\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ca href=\"https://github.com/btholt/project-files-for-complete-intro-to-containers-v2/blob/main/intro-to-dockerfiles/Dockerfile\"\u003e⛓️ Link to the Dockerfile\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe first thing on each line (\u003ccode\u003eFROM\u003c/code\u003e and \u003ccode\u003eCMD\u003c/code\u003e in this case) are called \u003cem\u003einstructions\u003c/em\u003e. They don\u0026#39;t technically have to be all caps but it\u0026#39;s convention to do so so that the file is easier to read. Each one of these instruction incrementally changes the container from the state it was in previously, adding what we call a \u003cem\u003elayer\u003c/em\u003e.\u003c/p\u003e\n\u003cp\u003eLet\u0026#39;s go ahead and build our container. Run (from inside of the directory of where your Dockerfile is)\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker build .\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou should see it out put a bunch of stuff and it\u0026#39;ll leave you with the hash of an image. After each instruction, you\u0026#39;ll see a hash similar to the ones we\u0026#39;ve been using for the IDs for the containers. You know why that is? It\u0026#39;s because each one of those layers is in-and-of themselves a valid container image! This ends up being important later and we\u0026#39;ll discuss it in a bit.\u003c/p\u003e\n\u003cp\u003eOur container has two instructions in its Dockerfile, but actually it has many, many more. How? The first instruction, \u003ccode\u003eFROM node:20\u003c/code\u003e actually means \u003cem\u003estart\u003c/em\u003e with the \u003ccode\u003enode\u003c/code\u003e container. That container itself \u003ca href=\"https://github.com/nodejs/docker-node/blob/master/Dockerfile-debian.template\"\u003ecomes from another Dockerfile\u003c/a\u003e which build its own container, which itself \u003ca href=\"https://github.com/docker-library/buildpack-deps\"\u003ecomes from another Dockerfile\u003c/a\u003e, which comes ultimately from the \u003ca href=\"https://hub.docker.com/_/debian/\"\u003eDebian\u003c/a\u003e image.\u003c/p\u003e\n\u003cp\u003eThis is something very powerful about Docker: you can use images to build other images and build on the work of others. Instead of having to worry about how to install Debian and all the necessary items to build Node.js from its source, we can just start with a well-put-together image from the community.\u003c/p\u003e\n\u003cp\u003eOkay, so we start with \u003ccode\u003enode:20\u003c/code\u003e and then we add the \u003ccode\u003eCMD\u003c/code\u003e instruction. There will only ever be one of these in effect in a Dockerfile. If you have multiple it\u0026#39;ll just take the last one. This is what you want Docker to do when someone runs the container. In our case, we\u0026#39;re running \u003ccode\u003enode -e \u0026quot;console.log(\u0026#39;hi lol\u0026#39;)\u0026quot;\u003c/code\u003e from within the container. \u003ccode\u003enode -e\u003c/code\u003e, if you don\u0026#39;t know, will run whatever is inside of the quotes with Node.js. In this case, we\u0026#39;re logging out \u003ccode\u003ehi lol\u003c/code\u003e to the console.\u003c/p\u003e\n\u003cp\u003eYou \u003cem\u003ecan\u003c/em\u003e put \u003ccode\u003eCMD node -e \u0026quot;console.log(\u0026#39;hi lol\u0026#39;)\u0026quot;\u003c/code\u003e as that last line and it\u0026#39;ll work but it\u0026#39;s not the preferred way of doing it. This won\u0026#39;t actually go through bash which itself is simpler and usually safer. I do it this way because the docs strongly encourage you to do it this way.\u003c/p\u003e\n\u003cp\u003eSo, in essence, our containers nabs a \u003ccode\u003enode:20\u003c/code\u003e container and then when we have it execute a \u003ccode\u003enode\u003c/code\u003e command when you run it. Let\u0026#39;s try it. Grab the hash from your build and run\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker run \u0026lt;ID\u0026gt;\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIt\u0026#39;s a little inconvenient to always have to refer to it by ID, it\u0026#39;d be easier if it had a name. So let\u0026#39;s do that! Try\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker build . --tag my-node-app \u003cspan class=\"hljs-comment\"\u003e## or -t instead of --tag\u003c/span\u003e\ndocker run my-node-app\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eMuch easier to remember the name rather than a hash. If you want to version it yourself, you can totally do this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker build -t my-node-app:1 .\ndocker run my-node-app:1\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNow change your \u003ccode\u003eDockerfile\u003c/code\u003e so that it logs out \u003ccode\u003ewat\u003c/code\u003e instead of \u003ccode\u003ehi lol\u003c/code\u003e. After you do that.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-bash\"\u003edocker build -t my-node-app:2 .\ndocker run my-node-app:2\ndocker run my-node-app:1\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou can version your containers and hold on to older ones, just in case!\u003c/p\u003e\n","markdown":"\nSo far we've been focusing a lot on running containers and haven't much dug into building them. This is on purpose because most of benefit of containers for developers comes from the running of containers. If you learn one thing, it should be how to run them. In fact I'll event venture to say that _most_ developers really only ever need to know how to run them. But you, you're going to learn how to write them. It's an extra superpower.\n\nThat said, let's learn to build our own containers. We'll again be using Docker for this though there are other ways to do this. Docker has a special file called a `Dockerfile` which allows you to outline how a container will be built. Each line in a Docker file is a new a directive of how to change your Docker container.\n\nA _big key_ with Docker container is that they're supposed to be disposable. You should be able to create them and throw them away as many times as necessary. In other words: adopt a mindset of making everything short-lived. There are other, better tools for long-running, custom containers.\n\nThe (imperfect) analogy that people use sometimes is your containers should be \"[cattle, not pets][cattle]\". You design containers so you can easily create and destroy them as much as necessary. The analogy here is that you name your pets and take special care of them whereas you have a thousand cattle and can't name or take special care of them, just the herd.\n\nLet's make the most basic Dockerfile ever. Let's make a new folder, maybe on your desktop. Put a file in there called `Dockerfile` (no extension.) In your file, put this.\n\n## The most basic Dockerfile-based Container\n\n```dockerfile\nFROM node:20\n\nCMD [\"node\", \"-e\", \"console.log(\\\"hi lol\\\")\"]\n```\n\n[⛓️ Link to the Dockerfile][dockerfile]\n\nThe first thing on each line (`FROM` and `CMD` in this case) are called _instructions_. They don't technically have to be all caps but it's convention to do so so that the file is easier to read. Each one of these instruction incrementally changes the container from the state it was in previously, adding what we call a _layer_.\n\nLet's go ahead and build our container. Run (from inside of the directory of where your Dockerfile is)\n\n```bash\ndocker build .\n```\n\nYou should see it out put a bunch of stuff and it'll leave you with the hash of an image. After each instruction, you'll see a hash similar to the ones we've been using for the IDs for the containers. You know why that is? It's because each one of those layers is in-and-of themselves a valid container image! This ends up being important later and we'll discuss it in a bit.\n\nOur container has two instructions in its Dockerfile, but actually it has many, many more. How? The first instruction, `FROM node:20` actually means _start_ with the `node` container. That container itself [comes from another Dockerfile][docker-node] which build its own container, which itself [comes from another Dockerfile][buildpack], which comes ultimately from the [Debian][debian] image.\n\nThis is something very powerful about Docker: you can use images to build other images and build on the work of others. Instead of having to worry about how to install Debian and all the necessary items to build Node.js from its source, we can just start with a well-put-together image from the community.\n\nOkay, so we start with `node:20` and then we add the `CMD` instruction. There will only ever be one of these in effect in a Dockerfile. If you have multiple it'll just take the last one. This is what you want Docker to do when someone runs the container. In our case, we're running `node -e \"console.log('hi lol')\"` from within the container. `node -e`, if you don't know, will run whatever is inside of the quotes with Node.js. In this case, we're logging out `hi lol` to the console.\n\nYou _can_ put `CMD node -e \"console.log('hi lol')\"` as that last line and it'll work but it's not the preferred way of doing it. This won't actually go through bash which itself is simpler and usually safer. I do it this way because the docs strongly encourage you to do it this way.\n\nSo, in essence, our containers nabs a `node:20` container and then when we have it execute a `node` command when you run it. Let's try it. Grab the hash from your build and run\n\n```bash\ndocker run \u003cID\u003e\n```\n\nIt's a little inconvenient to always have to refer to it by ID, it'd be easier if it had a name. So let's do that! Try\n\n```bash\ndocker build . --tag my-node-app ## or -t instead of --tag\ndocker run my-node-app\n```\n\nMuch easier to remember the name rather than a hash. If you want to version it yourself, you can totally do this:\n\n```bash\ndocker build -t my-node-app:1 .\ndocker run my-node-app:1\n```\n\nNow change your `Dockerfile` so that it logs out `wat` instead of `hi lol`. After you do that.\n\n```bash\ndocker build -t my-node-app:2 .\ndocker run my-node-app:2\ndocker run my-node-app:1\n```\n\nYou can version your containers and hold on to older ones, just in case!\n\n[buildpack]: https://github.com/docker-library/buildpack-deps\n[debian]: https://hub.docker.com/_/debian/\n[docker-node]: https://github.com/nodejs/docker-node/blob/master/Dockerfile-debian.template\n[cattle]: http://cloudscaling.com/blog/cloud-computing/the-history-of-pets-vs-cattle/\n[dockerfile]: https://github.com/btholt/project-files-for-complete-intro-to-containers-v2/blob/main/intro-to-dockerfiles/Dockerfile\n","slug":"intro-to-dockerfiles","title":"Intro to Dockerfiles","section":"Dockerfiles","icon":"file-lines","filePath":"/home/runner/work/complete-intro-to-containers-v2/complete-intro-to-containers-v2/lessons/04-dockerfiles/A-intro-to-dockerfiles.md","nextSlug":"/lessons/dockerfiles/build-a-nodejs-app","prevSlug":"/lessons/docker/docker-cli"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"dockerfiles","slug":"intro-to-dockerfiles"},"buildId":"nARcRKX1ZlcrYUdSUSS9z","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>